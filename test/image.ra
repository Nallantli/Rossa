load "sdl";

SDL.INIT();

w := new SDL.Window("Image Test", 800, 600);
r := w.getRenderer();

image1 := new SDL.Image("test/res/suki.png");
t1 := new SDL.Texture(image1, 200, 200);
t2 := new SDL.Texture(image1, 200, 200);
t3 := new SDL.Texture(image1, 200, 200);
t4 := new SDL.Texture(image1, 600, 600);

r.put(t1, 0, 0);
r.put(t2, 0, 200);
r.put(t3, 0, 400);
r.put(t4, 200, 0);

hue := 0;
r1 := 0;
r2 := 0;
r3 := 0;

font := new SDL.Font("test/res/unifont.ttf", 16);
fpsText := new SDL.Text(font, "", Color.WHITE);
r.put(fpsText, 0, 0);

start := clock.milliseconds();
fpsCounter := 0;
fpsTimer := clock.milliseconds();
while SDL.Event.poll()["type"] != SDL.Event.QUIT do {
	if (lapse := clock.milliseconds()) - start > 10 then {
		start = lapse;
		hue = (hue + 0.1) % 360;
		r1 = (r1 + 1) % 360;
		r2 = (r2 + 0.5) % 360;
		r3 = (r3 + 0.25) % 360;
		t4.setColor(Color.HSL(hue / 360, 1, 0.5));
		t1.setAngle(r1);
		t2.setAngle(r2);
		t3.setAngle(r3);
		r.update();
		fpsCounter += 1;

		if lapse - fpsTimer > 1000 then {
			fpsTimer = lapse;
			fpsText.setText("FPS: " + (fpsCounter -> String));
			fpsCounter = 0;
		}
	}
}

SDL.QUIT();